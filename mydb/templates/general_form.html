{% extends "layout.html" %}
{% block title %}Create {{ dblabel }} Database{% endblock %}
{% block head %}
{{ super() }}
{% endblock %}

{% block content %}
  <div id="container">

<div class="form-container">
  <div id="content">
    <div class="title">
      <h4>Create New {{ dblabel }} Container</h4> <!-- added by hand -->
    </div>

    <form method="POST" action="{{ url_for('created') }}">
      <input type="hidden" name="dbengine" value="{{ dblabel }}">
      <input type="hidden" name="username" value="{{ session.username if session.username else '' }}">
      <input type="hidden" name="manager" value="{{ session.manager if session.manager else '' }}">

      <!-- Database Configuration Section -->
      <div class="form-section">
        <h3>Database Configuration</h3>
        <div class="form-grid">
          <div class="form-field">
            <label for="dbname">Database Name<span class="required">*</span></label>
            <input type="text" name="dbname" id="dbname" tabindex="10" required>
            <span class="field-hint">Lowercase letters, numbers, and underscores only</span>
          </div>

          <div class="form-field">
            <label for="dbname">Docker Service Name<span class="required">*</span></label>
            <input type="text" name="Name" id="Name" tabindex="20" required>
            <span class="field-hint">Must be unique to MyDB</span>
          </div>

          <div class="form-field">
            <label for="dbuser">Database Username <span class="required">*</span></label>
            <input type="text" name="dbuser" id="dbuser" tabindex="30"
                   value="{{ session.username if session.username else '' }}" required>
          </div>

          <div class="form-field">
            <label for="dbuserpass">Database Password <span class="required">*</span></label>
            <input type="password" name="dbuserpass" id="dbuserpass" tabindex="40" autocomplete="new-password" required>
            <span class="field-hint">Minimum 8 characters recommended</span>
          </div>

          <div class="form-field">
            <label for="image">{{ dblabel }} Version <span class="required">*</span></label>
            <select name="image" id="image" tabindex="50" required>
              {% for img in image_list %}
              <option value="{{ img[1] }}" {% if loop.first %}selected{% endif %}>
                {{ img[0] }}
              </option>
              {% endfor %}
            </select>
          </div>

          <div class="form-field">
            <label for="backup_freq">Backup Frequency <span class="required">*</span></label>
            <select name="backup_freq" id="backup_freq" tabindex="57" required>
              <option value="Daily" selected>Daily</option>
              <option value="Weekly">Weekly</option>
              <option value="Never">Never</option>
            </select>
          </div>
          {% if dblabel == "MariaDB" %}
          <div class="form-field">
            <label for="EAR">Encryption at Rest <span class="required">*</span></label>
            <select name="EAR" id="EAR" tabindex="58" required>
              <option value="No" selected>No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          {% endif %}
        </div>
      </div>

      <!-- Contact Information Section -->
      <div class="form-section">
        <h3>Contact Information</h3>
        <div class="form-grid">
          <div class="form-field">
            <label for="owner">Contact Name <span class="required">*</span></label>
            <input type="text" name="owner" id="owner" tabindex="60"
                   value="{{ session.displayName if session.displayName else '' }}" required>
          </div>

          <div class="form-field">
            <label for="contact">Contact Email <span class="required">*</span></label>
            <input type="email" name="contact" id="contact" tabindex="70"
                   value="{{ session.mail if session.mail else '' }}" required>
          </div>

          <div class="form-field full-width">
            <label for="department">Department<span class="required">*</span></label>
            <input type="text" name="department" id="department" tabindex="80"
                   value="{{ session.department if session.department else ''}}" required>
          </div>

          <div class="form-field full-width">
            <label for="description">Description <span class="required">*</span></label>
            <input type="text" name="description" id="description" tabindex="80"
                   placeholder="Brief description of the database purpose" required>
          </div>

          <div class="form-field">
            <label for="app_name">Application Name (optional)</label>
            <input type="text" name="app_name" id="app_name" tabindex="90">
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <div style="text-align: center; margin-top: 2rem;">
        <button type="submit">Submit</button>
      </div>
    </form>
  </div>
</div>
</div>
{% endblock %}
